<!DOCTYPE html>
<html lang="kk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Тойға шақыру</title>
  <link rel="stylesheet" href="./index.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
</head>
<body>

  <!-- Hero -->
  <div class="hero">
    <img
      src="public/groom-bride_273784-850.avif"
      alt="Силуэт жениха и невесты под цветочной аркой"
      class="hero-bg__img"
      loading="lazy"
    />
  </div>

  <div class="hero-text container">
    <h1 class="kurmetti">Құрметті қонақтар!</h1>
    <p class="shaktext">Ұлымыз Жасұлан мен келініміз Гүлденнің тойына шақырамыз.</p>
    <button class="btn rounded-5 btn-success btn-play" id="btnHero">
      <svg viewBox="0 0 64 64"><path d="M16 12v40l36-20z"/></svg> Әуен қосу
    </button>
  </div>

  <main class="container">
    <!-- Event card -->
    <section class="card rounded-5">
      <img src="./public/flowers_top.png" class="w-50 mx-auto">
      <div class="card-body">
        <h2>Той жайлы</h2>
        <p>Той иелері: <strong>Ерболат – Айнұр</strong></p>
        <hr>
        <p>Тойдың басталу уақыты:<br><strong>22.06.2025 / сағат 12:00</strong></p>
        <p>Тойдың басталуына қалды:</p>
        <div class="countdown">
          <div><span id="days">--</span><small>күн</small></div>
          <div><span id="hours">--</span><small>сағат</small></div>
          <div><span id="minutes">--</span><small>минут</small></div>
          <div><span id="seconds">--</span><small>секунд</small></div>
        </div>
        <hr>
        <p>Тойдың мекен-жайы:<br>Рыскулова көшесі 57а/1, Ақтөбе<br><strong>"Гаухар" мейрамханасы</strong></p>
        <div class="buttons">
          <a class="btn rounded-5 btn-success" href="https://2gis.kz/aktobe/geo/70000001032399700/57.131611,50.313008"
            target="_blank" class="btn map-btn">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-globe-central-south-asia-fill" viewBox="0 0 16 16">
              <path fill-rule="evenodd" d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0m0 1a7 7 0 0 0-3.115.73.48.48 0 0 0 .137.292.488.488 0 0 1-.126.78l-.292.145a.7.7 0 0 0-.187.136l-.48.48a1 1 0 0 1-1.023.242l-.02-.007a1 1 0 0 0-.461-.041A6.97 6.97 0 0 0 1 8a6.96 6.96 0 0 0 .883 3.403l.86-.213c.444-.112.757-.512.757-.971v-.184a1 1 0 0 1 .445-.832l.04-.026a1 1 0 0 0 .153-1.54L3.12 6.622a.415.415 0 0 1 .542-.624l1.09.817a.5.5 0 0 0 .523.047A.5.5 0 0 1 6 7.31v.455a.8.8 0 0 0 .13.432l.796 1.193a1 1 0 0 1 .116.238l.73 2.19a1 1 0 0 0 .949.683h.058a1 1 0 0 0 .949-.684l.73-2.189q.042-.127.116-.238l.791-1.187A.45.45 0 0 1 11.743 8c.16 0 .306.083.392.218.557.875 1.63 2.282 2.365 2.282l.04-.003A7 7 0 0 0 8 1"/>
            </svg>
            Карта арқылы ашу
          </a>
            <button class="btn rounded-5 btn-success btn-play" id="btnCard">
              <svg viewBox="0 0 64 64"><path d="M16 12v40l36-20z"/></svg> Әуен қосу
            </button>
        </div>
      </div>
      <img src="./public/flowers_bottom.png" class="w-100 m-auto mb-3">
    </section>

    <!-- Photo album -->
    


    <!-- Owners -->
    <section class="owners-section">
      <h2>Құрметпен</h2>
      <div class="owners-list">
        <div class="owner">
          <img src="./public/insta_ava_1.jpg" alt="Жасұлан" class="owner-img">
          <div class="owner-name">Жасұлан</div>
          <a href="https://instagram.com/your_insta" target="_blank" class="insta-btn rounded-3">
            <svg viewBox="0 0 24 24"><path d="M7.75 2h8.5A5.75 5.75 0 0 1 22 7.75v8.5A5.75 5.75 0 0 1 16.25 22h-8.5A5.75 5.75 0 0 1 2 16.25v-8.5A5.75 5.75 0 0 1 7.75 2zm0 1.5A4.25 4.25 0 0 0 3.5 7.75v8.5A4.25 4.25 0 0 0 7.75 20.5h8.5a4.25 4.25 0 0 0 4.25-4.25v-8.5A4.25 4.25 0 0 0 16.25 3.5h-8.5z"/><circle cx="12" cy="12" r="3.5"/><circle cx="17.5" cy="6.5" r="1.25"/></svg>
            @your_insta
          </a>
        </div>
        <div class="owner">
          <img src="./public/insta_ava_1.jpg" alt="Гүлден" class="owner-img">
          <div class="owner-name">Гүлден</div>
          <a href="https://instagram.com/your_insta" target="_blank" class="insta-btn rounded-3">
            <svg viewBox="0 0 24 24"><path d="M7.75 2h8.5A5.75 5.75 0 0 1 22 7.75v8.5A5.75 5.75 0 0 1 16.25 22h-8.5A5.75 5.75 0 0 1 2 16.25v-8.5A5.75 5.75 0 0 1 7.75 2zm0 1.5A4.25 4.25 0 0 0 3.5 7.75v8.5A4.25 4.25 0 0 0 7.75 20.5h8.5a4.25 4.25 0 0 0 4.25-4.25v-8.5A4.25 4.25 0 0 0 16.25 3.5h-8.5z"/><circle cx="12" cy="12" r="3.5"/><circle cx="17.5" cy="6.5" r="1.25"/></svg>
            @your_insta
          </a>
        </div>
      </div>
    </section>

    <!-- RSVP -->
    <h2 class="text-center">Тойға келетіндігіңізді растаңыз:</h2>
    <form id="rsvp-form">
      <div class="radios">
        <label><input type="radio" name="response" value="Иә, өзім барамын!" checked> Иә, өзім барамын!</label>
        <label><input type="radio" name="response" value="Жұбайыммен бірге барамын"> Жұбайыммен бірге барамын</label>
        <label><input type="radio" name="response" value="Өкінішке орай, келе алмаймын"> Өкінішке орай, келе алмаймын</label>
      </div>
      <input class="rounded-3" type="text" name="name" placeholder="Аты-жөніңіз" required>
      <textarea class="rounded-3" name="message" rows="4" placeholder="Той иелеріне тілегіңіз" required></textarea>
      <button class="btn btn-success justify-content-center rounded-3" type="submit">Жіберу</button>
    </form>

    <!-- Wishes slider -->
    <div class="d-flex justify-content-center flex-row">
      <h2>Ізгі тілектер:</h2>
    </div>
    <div class="wishes mt-1">
      <div class="slides"></div>
      <div class="arrows">
        <button class="btn btn-sm rounded-5 btn-outline-success h-25" id="prevWish">&lt;</button>
        <button class="btn btn-sm rounded-5 btn-outline-success h-25" id="nextWish">&gt;</button>
      </div>
      <div class="dots"></div>
    </div>
  </main>

  <!-- Firebase + JS -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
    import {
      getFirestore, collection, addDoc, getDocs,
      query, orderBy, serverTimestamp
    } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js';

    // Firebase config
    const cfg = {
      apiKey: "AIzaSyC9vMqxWup-XCbQAno0tij_anivznTJx3E",
      authDomain: "zhasiktoi.firebaseapp.com",
      projectId: "zhasiktoi",
      storageBucket: "zhasiktoi.appspot.com",
      messagingSenderId: "661605942620",
      appId: "1:661605942620:web:a7b3ee50fd0701be736d99"
    };
    const app = initializeApp(cfg);
    const db  = getFirestore(app);
    const col = collection(db,'wishes');

    // Countdown
    (()=>{
      const dl=new Date(2025,5,22,12,0);
      const ids=['days','hours','minutes','seconds'].map(i=>document.getElementById(i));
      function upd(){
        const diff=dl-new Date();
        if(diff<0)return clearInterval(iid);
        const d=Math.floor(diff/864e5),
              h=Math.floor(diff/36e5)%24,
              m=Math.floor(diff/6e4)%60,
              s=Math.floor(diff/1e3)%60;
        [d,h,m,s].forEach((v,i)=>ids[i].textContent=String(v).padStart(2,'0'));
      }
      upd();var iid=setInterval(upd,1e3);
    })();

    // Audio
const player = new Audio('sound_cut.mp3');
    let playing=false;
    document.querySelectorAll('#btnHero,#btnCard').forEach(b=>{
      b.addEventListener('click',()=>{
        playing?player.pause():player.play();
        playing=!playing;
        b.innerHTML = playing
          ? '<svg viewBox="0 0 64 64"><path d="M16 12h12v40H16zm20 0h12v40H36z"/></svg> Әуен өшіру'
          : '<svg viewBox="0 0 64 64"><path d="M16 12v40l36-20z"/></svg> Әуен қосу';
      });
    });

    // RSVP
    document.getElementById('rsvp-form').addEventListener('submit',async e=>{
      e.preventDefault();
      const fm=e.target;
      const resp=fm.response.value,
            name=fm.name.value.trim(),
            msg=fm.message.value.trim();
      if(!name||!msg)return;
      await addDoc(col,{response:resp,name,msg,created:serverTimestamp()});
      fm.reset();loadWishes();
    });

    // Wishes slider
    let items=[],ci=0;
    const slidesEl=document.querySelector('.wishes .slides');
    const dotsEl  =document.querySelector('.wishes .dots');
    async function loadWishes(){
      const q=query(col,orderBy('created','desc'));
      const s=await getDocs(q);
      items=s.docs.map(d=>({...d.data(),date:new Date(d.data().created.seconds*1e3).toLocaleString('kk-KZ')}));
      build();
    }
    function build(){
      slidesEl.innerHTML='';dotsEl.innerHTML='';
      items.forEach((it,i)=>{
        const sl=document.createElement('div');
        sl.className='slide'+(i===0?' active':'');
        sl.innerHTML=`<h4>${it.name} → ${it.response}</h4><p>${it.msg}</p><small>${it.date}</small>`;
        slidesEl.append(sl);
        const dt=document.createElement('span');
        dt.className='dot'+(i===0?' active':'');
        dt.onclick=()=>show(i);
        dotsEl.append(dt);
      });
      ci=0;
    }
    function show(n){
      const sls=document.querySelectorAll('.wishes .slide');
      const dts=document.querySelectorAll('.wishes .dot');
      sls.forEach(s=>s.classList.remove('active'));
      dts.forEach(d=>d.classList.remove('active'));
      sls[n].classList.add('active');
      dts[n].classList.add('active');
      ci=n;
    }
    document.getElementById('prevWish').onclick=()=>show((ci-1+items.length)%items.length);
    document.getElementById('nextWish').onclick=()=>show((ci+1)%items.length);
    loadWishes();
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>
</body>
</html>
